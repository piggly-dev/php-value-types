<?php
namespace Piggly\Tests\ValueTypes\Advanced;

use PHPUnit\Framework\TestCase;
use Piggly\ValueTypes\Advanced\CreditCardType;

/**
 * @coversDefaultClass \Piggly\ValueTypes\Advanced\CreditCardType
 */
class CreditCardTypeTest extends TestCase
{
	/**
	 * Assert if $value is validated as $expected.
	 *
	 * @covers ::validate
	 * @covers ::assert
	 * @covers ::__construct
	 * @dataProvider dataValues
	 * @test Expecting positive assertion.
	 * @param boolean $expected Expected result.
	 * @param boolean $value Value to validate
	 * @return boolean
	 */
	public function canValidate ( bool $expected, string $value )
	{ $this->assertEquals($expected, (new CreditCardType($value))->validate()); }

	/**
	 * Assert if $value is masked as $expected.
	 *
	 * @covers ::masked
	 * @covers ::__construct
	 * @dataProvider dataToMask
	 * @test Expecting positive assertion.
	 * @param string $expected Expected result.
	 * @param string $value Value to validate
	 * @return boolean
	 */
	public function canMask ( string $expected, string $value, bool $keepLenght = true )
	{ $this->assertEquals($expected, (new CreditCardType($value))->masked($keepLenght)); }

	/**
	 * A list with random values to validate.
	 * Provider to canValidate() method.
	 * - Generated by fakerphp.
	 * @return array
	 */
	public function dataValues () : array
	{
		$arr = [];
		$faker = \Faker\Factory::create();

		for ( $i = 0; $i < 50; $i++ )
		{ $arr[] = [true, $faker->creditCardNumber()]; }

		return $arr;
   }

	/**
	 * A list with random values to mask.
	 * Provider to canMask() method.
	 * - Generated by fakerphp.
	 * @return array
	 */
	public function dataToMask () : array
	{
		return [
			['***********6944','348625973956944'],
			['************3331','4439941208283331'],
			['************1769','5831738322171769'],
			['**********6244','38187236346244'],
			['************8808','4752308076058808'],
			['************2144','5875712119282144'],
			['************7467','4553987029417467'],
			['************8474','5214661272278474'],
			['************0429','6225252855850429'],
			['************2679','4117601055982679'],
			['************8522','5644496891398522'],
			['************8374','5020972686808374'],
			['************7987','5207245651707987'],
			['************3923','5758152816383923'],
			['**********3509','38437074193509'],
			['************1090','4792465494431090'],
			['************8473','4622703628938473'],
			['***********3335','340625486303335'],
			['***********5603','348289645925603'],
			['************2729','5665882340432729'],
			['************4830','4411709405184830'],
			['************6885','5647230772796885'],
			['************2661','5053987003482661'],
			['************5435','4624590310155435'],
			['************6122','5421843635636122'],
			['************0470','5223022608840470'],
			['************1044','5545915357701044'],
			['************2775','6442209128632775'],
			['************4800','3886292678014800'],
			['************0168','4811058603080168'],
			['************5051','3819681220865051'],
			['************0335','4514163487050335'],
			['************8271','5104599071618271'],
			['************7375','4666205202757375'],
			['************2606','5055388281482606'],
			['************7820','4862424130237820'],
			['************9186','4455984399459186'],
			['************7917','6363687038627917'],
			['************7683','4706445480617683'],
			['************6023','6505799480456023'],
			['************7227','4514161925707227'],
			['************6527','5767664732766527'],
			['************2508','4499664208142508'],
			['************2520','4086822962172520'],
			['************4943','4514282214334943'],
			['**********4430','38533982264430'],
			['************2127','5710672973452127'],
			['************5510','5013575370255510'],
			['**********0721','38678279270721'],
			['**********9029','30179577499029'],
			['*4148','4545715084844148', false],
			['*4705','4824153869944705', false],
			['*6553','3884686541136553', false],
			['*4596','4335121079674596', false],
			['*7953','4747208385067953', false],
			['*1948','6048747114451948', false],
			['*2106','5512383517882106', false],
			['*0334','5908680532620334', false],
			['*8295','4514165499078295', false],
			['*3105','6033731597963105', false],
			['*1666','6223312471751666', false],
			['*0296','6363686158560296', false],
			['*2692','38018962602692', false],
			['*8824','4335274180818824', false],
			['*3856','6052485233963856', false],
			['*1560','5795465184011560', false],
			['*4962','4599787168984962', false],
			['*7005','6362971766217005', false],
			['*0721','5968757156530721', false],
			['*3140','4623655337173140', false],
			['*4589','372108175924589', false],
			['*1379','36317932671379', false],
			['*6940','5167509257086940', false],
			['*8846','348276802248846', false],
			['*2700','38501999052700', false],
			['*5938','5419697896755938', false],
			['*0302','4482189200370302', false],
			['*1113','6363687681831113', false],
			['*1616','347368166231616', false],
			['*6572','5193957384166572', false],
			['*1560','4968905760361560', false],
			['*3096','4765353417303096', false],
			['*9833','4593468308649833', false],
			['*5535','4154316384705535', false],
			['*2035','5549276993982035', false],
			['*9999','4745035484239999', false],
			['*9114','5309496767209114', false],
			['*0201','6532455697880201', false],
			['*9964','4938337205529964', false],
			['*1231','4934300177291231', false],
			['*3540','4667246885063540', false],
			['*6585','5724578734366585', false],
			['*8101','5219294633928101', false],
			['*7653','6220194131337653', false],
			['*1924','5053376896491924', false],
			['*9834','4011692115169834', false],
			['*6866','4476209477086866', false],
			['*7236','4491240375737236', false],
			['*5191','38111843675191', false],
			['*2498','4766612172472498', false],
		];
   }
}